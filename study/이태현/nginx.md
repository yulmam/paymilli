## 정의

- nginx는 오픈소스이며, 웹 서버와 리버스 프록시 역할을 함
- HTTP 요청을 처리하며, 다른 서버로 요청을 전달
- 아파치에 비해 경량화되어 있어, EC2 프리티어에서 잘 돌아감 → 고성능, 높은 안정성

> 포워드 프록시 : 클라이언트 ↔ 여기 ↔ 인터넷      / 캐싱, 익명성, 액세스 제어
리버스 프록시 : 인터넷 ↔ 여기 ↔ 서버                 / 트래픽 분산, 보안, 캐싱처리
> 

## 아파치

- 클라이언트의 요청이 들어올 때마다 하나의 프로세스 생성
    - 프로세스 만드는 작업은 시간 소요가 많음
    - prefork 방식으로 요청이 오기전에 미리 프로세스를 만들어 둠
    - 단점 : 동시에 많은 커넥션이 있을 때, 메모리 부족 야기

nginx

- 이벤트 기반 처리 구조방식
- 마스터 프로세스가 cpu 수만큼 워커 프로세스 생성(보통 cpu수만큼 만듦)

nginx에서 이벤트란

- 커넥션의 생성, 제거, 처리를 의미한다

이벤트(요청)가 처리되는 과정

1. 이벤트는 OS커널에서 큐형식으로 `worker process`에게 전달
    1.  이벤트들이 하나의 큐상태로 비동기상태로 대기
2. `worker process`는 이벤트를 `poll()`하며 하나씩 해결

⇒ 커넥션 낭비현상 감소 효과
⇒ prefork에서는 connect이 생성되어 프로세스가 할당되고 나서 작업이 없는 경우인, 프로세스가 놀고 있는 상태가 없음

- 만약 이 요청이 I/O작업을 하여 시간이 오래 걸리는 경우?
    - 스레드풀에 요청을 넘겨, 병렬적으로 실행함

nginx 사용 이유

### 1. **낮은 EC2 메모리 성능과 정적 콘텐츠 제공**

- **EC2 메모리 성능**: Amazon EC2 (Elastic Compute Cloud)는 AWS에서 제공하는 가상 서버입니다. 이 가상 서버의 성능, 특히 메모리 성능이 낮다면, 웹 애플리케이션이 느리게 동작하거나 많은 요청을 처리하는 데 어려움을 겪을 수 있습니다.
- **정적 콘텐츠 제공**: NGINX는 매우 빠르고 효율적으로 정적 콘텐츠(HTML, CSS, JavaScript, 이미지 파일 등)를 제공할 수 있습니다. EC2 인스턴스의 메모리 성능이 낮을 때, NGINX의 가벼운 메모리 사용과 빠른 정적 콘텐츠 제공 능력은 큰 장점이 됩니다. 특히 CSS와 JS 파일은 웹 페이지 로딩에 필수적이기 때문에, 이를 빠르게 제공하는 것은 사용자 경험을 크게 개선합니다.

### 2. **SSL 인증서 발급과 관리의 용이성**

- **SSL 인증서**: SSL(Secure Sockets Layer) 인증서는 웹 서버와 클라이언트 간의 데이터를 암호화하여 전송할 수 있도록 해주는 디지털 인증서입니다. 웹사이트가 HTTPS 프로토콜을 사용하여 안전하게 통신하려면 SSL 인증서가 필요합니다.
- **Let’s Encrypt**: Let’s Encrypt는 무료로 SSL 인증서를 발급해주는 인증 기관입니다. NGINX는 Let’s Encrypt와의 통합이 잘 되어 있어서, SSL 인증서를 발급받고 이를 NGINX 서버에 설정하는 과정이 매우 간단합니다.
- **자동 갱신**: Let’s Encrypt가 발급하는 SSL 인증서는 유효 기간이 90일로 짧습니다. 그러나 NGINX를 사용하면 이 인증서를 쉽게 자동 갱신할 수 있는 기능을 활용할 수 있습니다. 이로 인해 관리 부담이 적습니다.

### 3. **캐싱 및 프록시 설정의 간편함**

- **캐싱**: 웹 서버에서 캐싱은 자주 요청되는 콘텐츠를 서버의 메모리나 디스크에 저장해두었다가, 다시 요청이 들어오면 빠르게 제공하는 방법입니다. NGINX는 이러한 캐싱을 매우 효율적으로 처리할 수 있습니다. 캐싱 설정은 NGINX의 설정 파일(`nginx.conf`)에서 간단히 할 수 있습니다.
- **동적 캐싱**: 동적인 데이터는 캐싱하기 어렵기 때문에, Redis와 같은 별도의 캐시 서버를 사용하는 경우가 많습니다. Redis는 메모리 기반의 고속 키-값 저장소로, 주로 동적 데이터를 캐싱하는 데 사용됩니다. 여기서 동적 캐싱을 NGINX가 아닌 Redis로 처리했기 때문에 NGINX에서는 주로 정적 콘텐츠의 캐싱을 다룬 것입니다.
- **프록시 설정**: NGINX는 리버스 프록시(reverse proxy)로도 자주 사용됩니다. 이는 NGINX가 클라이언트로부터의 요청을 받아서, 이를 백엔드 서버(예: 애플리케이션 서버)로 전달하는 역할을 하는 것입니다. 프록시 설정 또한 NGINX에서 쉽게 할 수 있습니다.
